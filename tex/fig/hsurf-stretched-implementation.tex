\begin{figure*}[htbp!]
  \centering

\begin{minipage}{\textwidth}
  \scriptsize
  \setlength{\tabcolsep}{2.5pt}
  \begin{tabularx}{\textwidth}{
    r
    Y|Y|Y|Y|Y|Y|Y|Y|
    Y|Y|Y|Y|Y Y Y|Y
    |Y|Y|Y|Y|Y|Y|Y
    |Y|Y|Y|Y Y
    }
     { Time $\colorT$} & \textbf{0} & \textbf{1} & \textbf{2} & \textbf{3} & \textbf{4} & \textbf{5} & \textbf{6} & \textbf{7}
    & \textbf{8} & \textbf{9} & \textbf{10} & \textbf{11} & \textbf{12} %& 13 & 14 & 15
    % & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23
    &  \ldots
    & \textbf{28} & \textbf{29} & \textbf{30} & \textbf{31}
    & \textbf{32} & \textbf{33} & \textbf{34} & \textbf{35}
    & \textbf{36} & \textbf{37} & \textbf{38} & \textbf{39} & \textbf{40}
    & \ldots \\ \hline
   { Epoch $\colort$} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
    & 0 & 0 & 0 & 0 & 0 %& 13 & 14 & 15
    % & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23
    &  \ldots
    & 0 & 0 & 0 & 0
    & 1 & 1 & 1 & 1
    & 1 & 1 & 1 & 1 & 1
    & \ldots \\
     \rowcolor{lightgray!30}
   { Meta-epoch $\colortau$} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
    & 0 & 0 & 0 & 0 & 0 %& 13 & 14 & 15
    % & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23
    &  \ldots
    & 0 & 0 & 0 & 0
    & 1 & 1 & 1 & 1
    & 1 & 1 & 1 & 1 & 1
    & \ldots \\
    { \scriptsize$\colorH(\colorT)$} & 0 & 1 & 0 & 2 & 0 & 1 & 0 & 3
    & 0 & 1 & 0 & 2 & 0 %& 13 & 14 & 15
    % & 16 & 17 & 18 & 19 & 20 & 21 & 22 & 23
    &  \ldots
    & 0 & 1 & 0 & 5
    & 0 & 1 & 0 & 2
    & 0 & 1 & 0 & 3 & 0
    & \ldots \\ \hline
     { \scriptsize $\colorK(\colorT)$} & \textbf{0} & \textbf{1} & \textbf{17} & \textbf{2} & \textbf{10} & \textbf{18} & \textbf{25} & \textbf{3}
     & \textbf{7} & \textbf{11} & \textbf{14} & \textbf{19} & \textbf{22} & \ldots
 & \textbf{28} & \textbf{30} & \textbf{31} & \textbf{5} & {\tiny \texttt{\textbf{null\hphantom{}}}}  % \vspace{-3ex}
 & {\tiny \texttt{\textbf{null\hphantom{}}}} & {\tiny \texttt{\textbf{null\hphantom{}}}}  & \textbf{9} & {\tiny \texttt{\textbf{null\hphantom{}}}}
 & {\tiny \texttt{\textbf{null\hphantom{}}}} & {\tiny \texttt{\textbf{null\hphantom{}}}} & \textbf{13} & {\tiny \texttt{\textbf{null\hphantom{}}}}  &\ldots
  \end{tabularx}
\end{minipage}
\begin{subfigure}{\textwidth}
\vspace{-1ex}
\caption{\footnotesize Stretched policy site selection $\colorK(\colorT)$ with buffer size $\colorS=32$. Ingests marked \nullval{} indicate item discarded without storing.}
\label{fig:hsurf-stretched-implementation-site-selection}
\end{subfigure}

\begin{subfigure}[b]{\linewidth}
\includegraphics[width=\linewidth]{
binder/teeplots/41/num-generations=128+surface-size=32+viz=site-reservation-by-rank-spliced-at-heatmap+ext=}
\vspace{-4.5ex}\caption{
  Buffer composition across time, split by epoch with data items color-coded by hanoi value of ingestion time $\colorH(\colorTbar)$.
}
\label{fig:hsurf-stretched-implementation-schematic}
\end{subfigure}

\vspace{0.5ex}
\begin{minipage}[]{\textwidth}
 \vspace{-2pt}
  \begin{subfigure}[t]{0.65\linewidth}
    \vspace{0pt}
    \centering
  \includegraphics[width=0.88\linewidth,clip]{binder/teeplots/41/cnorm=log+num-generations=4096+surface-size=256+viz=site-ingest-depth-by-rank-heatmap+ynorm=linear+ext=.png}  % pdf cbar is scrambled
  \end{subfigure}%
  \begin{subfigure}[t]{0.35\linewidth}
  \vspace{-2pt}
  \caption{%
    \footnotesize
    Stored data item age across buffer sites for buffer size $\colorS=256$ from $\colorT=0$ to 4,096.
  }
  \label{fig:hsurf-stretched-implementation-heatmap}
\end{subfigure}
\end{minipage}

  \vspace{-0.5ex}
   \begin{minipage}[]{\textwidth}
   \vspace{-2pt}
  \begin{subfigure}[t]{0.65\linewidth}
  \vspace{0pt}
    \centering
    \includegraphics[width=0.88\linewidth,clip]{binder/teeplots/41/num-generations=4096+surface-size=64+viz=stratum-persistence-dripplot+ext=}
  \end{subfigure}%
  \begin{subfigure}[t]{0.35\linewidth}
  \vspace{-2pt}
  \caption{%
    \footnotesize
    Data item retention time spans by ingestion time point for buffer size $\colorS=64$ from $\colorT=0$ to 3,000.
  }
  \label{fig:hsurf-stretched-implementation-dripplot}
  \end{subfigure}
  \end{minipage}

  \vspace{-0.5ex}
 \begin{minipage}[]{\textwidth}
 \vspace{-2pt}
\begin{subfigure}[t]{0.65\linewidth}
\vspace{0pt}
  \centering
  \includegraphics[width=0.88\linewidth,clip]{binder/teeplots/41/hue=kind+surface-size=16+viz=criterion-satisfaction-lineplot+x=rank+y=stretched-criterion+ext=}
\end{subfigure}%
\begin{subfigure}[t]{0.35\linewidth}
\vspace{-2pt}
\caption{%
  \footnotesize
  Stretched criterion satisfaction across time points for buffer size $\colorS=16$.
}
\label{fig:hsurf-stretched-implementation-satisfaction}
\end{subfigure}
\end{minipage}

\vspace{-2ex}\caption{%
  \textbf{Stretched algorithm implementation.}
  \footnotesize
  Top panel \ref{fig:hsurf-stretched-implementation-site-selection} enumerates initial stretched policy site selection on a 32-site buffer.
  Panel \ref{fig:hsurf-stretched-implementation-schematic} summarizes how data items are ingested and retained over time within a 32-site buffer, color-coded by data items' hanoi values $\colorH(\colorTbar)$.
  Between $\colorT=0$ and $\colorT=127$, time is segmented into epochs $\colort=0$, $\colort=1$, and $\colort=2$.
  Spliced-in strips show hanoi values assigned to each buffer site for the upcoming epoch, separated into ``reservation segments'' by vertical black lines.
  Reservation segments occur in five recursively nested ``bunches'' --- (1) one 6-site reservation segment, (2) one 4-site reservation segment, (3) two 3-site segments, (4) four 2-site segments, and (5) eight 1-site segments.
  At each epoch, data items are filled into sites newly assigned for their ingestion-order hanoi value from left to right.
  In epoch 0, all sites are filled with a first data item.
  At subsequent epochs, the first site of all innermost-nested segments is ``invaded'' by new high \hv{} sites added to other segments.
  When data items are placed, they remain retained until invaded by a higher-\hv{} data item.
  This process continues until only one segment remains, as shown in Figure \ref{fig:hsurf-stretched-intuition-reservations}.
  Heatmap panel \ref{fig:hsurf-stretched-implementation-heatmap} shows the evolution of data item age at each site on a 256-bit field over the course of 4,096 time steps.
  Dripplot panel \ref{fig:hsurf-stretched-implementation-dripplot} shows retention spans for 3,000 ingested time points.
  Vertical lines span durations between ingestion and elimination for data items from successive time points.
  Time points previously eliminated are marked in red, although in this case they are largely obscured by crowding in small $\colorTbar$.
  Lineplot panel \ref{fig:hsurf-stretched-implementation-satisfaction} shows stretched criterion satisfaction on a 16-bit surface over $2^{16}$ timepoints.
  Lower and upper shaded areas are best- and worst-case bounds, respectively.
  }
\label{fig:hsurf-stretched-implementation}

\end{figure*}
