\begin{algorithm}[H]
\caption{Full Zhao tilted algorithm.}
\label{alg:zhao-tilted-full}
\begin{minipage}{0.5\textwidth}
    \hspace*{\algorithmicindent} \textbf{Given:} $\colorS \in \mathcal{N}$ \textcolor{teal}{\small//Buffer size}
    \hspace*{\algorithmicindent}    \begin{algorithmic}[1]
        \State $b \gets$ array, size $\colorS$ \textcolor{teal}{\small//Storage buffer}
        \State $w \gets [\colorS, \;\; 0]$ \textcolor{teal}{\small//Bucket size list}
        \For{$\colorT, \;\; v \in \mathrm{enumeratedStream}$} \textcolor{teal}{\small//Take stream indices and values}
        \If{$\colorT < \colorS$} \textcolor{teal}{\small//Handle initial fill\ldots}
        \State $b[\colorS - 1 - \colorT] \gets v$ \textcolor{teal}{\small//Store value}
        \State \textbf{continue} \textcolor{teal}{\small//Skip to next item}
        \EndIf
        \State $w[0] \gets w[0] + 1$  \textcolor{teal}{\small//Reflect incoming new item}
        \State $i \gets -1$
        \State $j \gets 0$
        \While{$w[j] \leq w[j + 1]$} \textcolor{teal}{\small//Find bucket larger than next}
        \State $i \gets i + w[j]$ \textcolor{teal}{\small//Jump forward bucket size}
        \State $j \gets j + 1$ \textcolor{teal}{\small//Increment bucket}
        \If{$j+1 = \lvert w \rvert$} \textcolor{teal}{\small//If at end of bucket list\ldots}
        \State $w \gets [w\ldots,\;\; 0]$ \textcolor{teal}{\small//\ldots append empty bucket}
        \EndIf
        \EndWhile
        \State $w[j] \gets w[j] - 2$ \textcolor{teal}{\small //Shrink donor bucket}
        \State $w[j - 1] \gets w[j - 1] + 1$ \textcolor{teal}{\small //Grow recipient bucket}
        \While{$i \geq 0$} \textcolor{teal}{\small//Shift data forward into cleared space\ldots}
        \State $b[i + 1] \gets b[i]$
        \State $i \gets i - 1$
        \EndWhile
        \State $b[0] \gets v$ \textcolor{teal}{\small// \ldots store new value at front}
        \EndFor
        \Return $b$ \textcolor{teal}{\small//Stored data}
    \end{algorithmic}
\end{minipage}
\end{algorithm}
