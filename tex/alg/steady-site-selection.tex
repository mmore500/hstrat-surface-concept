\begin{algorithm}[H]
\caption{Steady algorithm site selection $\colorK(\colorT)$.}
\label{alg:steady-site-selection}
\begin{minipage}{0.5\textwidth}
    \label{alg:example}
    \hspace*{\algorithmicindent} \textbf{Input:} $\colorS \in \{2^{\mathbb{N}}\},\;\; \colorT \in \mathbb{N}$ \Comment{Buffer size and current logical time}\\
    \hspace*{\algorithmicindent} \textbf{Output:} $\in [0 \twodots \colorS - 1) \cup \{\nullval\}$ \Comment{Selected site, if any}
    \begin{algorithmic}[1]
        \State $\colors \gets \Call{BitLength}{\colorS} - 1$
        \State $\colort \gets \Call{BitLength}{\colorT+1} - \colors $ \Comment{Current epoch (or negative)}
        \State $\colorh \gets \Call{CountTrailingZeros}{\colorT + 1}$ \Comment{Current \hv{}}
        \If{$\colorh < \colort$} \Comment{If not a top $n(\colorT)$ \hv{}\;\ldots}
        \State \Return \nullval \Comment{\ldots discard without storing}
        \EndIf
        \State $i \gets \Call{RightShift}{\colorT, \colorh + 1}$ \Comment{Hanoi value incidence}
        \If{$i = 0$} \Comment{Special case the 0th bunch}
        \State $\colork \gets 0$ \Comment{Bunch position}
        \State $o \gets 0$ \Comment{Within-bunch offset}
        \State $w \gets \colors$ \Comment{Segment width}
        \Else
        % \State $j \gets \left\lfloor i \right\rfloor_{\mathrm{bin}} - 1$ \Comment{Completed segments}
        \State $j \gets \Call{BitFloor}{i} - 1$ \Comment{Num full-bunch segments}
        \State $b \gets \Call{BitLength}{j}$ \Comment{Num full bunches}
        % \State $k_{b} \gets 2^{b}(\colors - 1) - (\colors - 1) - b2^{b} + 2^{b + 1} - 2$ \Comment{Bunch position}
        % \State $k_{b} \gets 2^{b}\colors - 2^{b} - \colors + 1 - b2^{b} + 2^{b + 1} - 2$ \Comment{Bunch position}
        % \State $k_{b} \gets 2^{b}(\colors - 1 - b + 2) - \colors + 1 - 2$ \Comment{Bunch position}
        \State $\colork \gets 2^{b}(\colors - b + 1) - 1$ \Comment{Bunch position}
        % \State $k_{b} \gets 2^{b}(\colors - b) + 2^{b + 1} - 2$ \Comment{Bunch position}
        \State $w \gets \colorh - \colort + 1$ \Comment{Segment width}
        \State $o \gets w (i - j - 1)$ \Comment{Within-bunch offset}
        \EndIf
        \State $p \gets \colorh \bmod w$ \Comment{Within-segment offset}
        \State \Return $\colork + o + p$ \Comment{Calculate placement site}
    \end{algorithmic}
\end{minipage}
\end{algorithm}
