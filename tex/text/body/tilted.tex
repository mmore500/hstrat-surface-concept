\section{Tilted Algorithm} \label{sec:tilted}

The tilted criterion favors recent data items, enjoining a record spaced proportionally to time elapsed since data item's ingest time, $\colorT - \colorTbar$.
This is opposite the stretched criterion, which favors early data items.

The tilted criterion can be formulated as minimization of the largest ratio of gap size to ingest time,
\begin{align*}
\frac{\colorG_{\colorT}(\colorTbar)}{\colorT - \colorTbar} \text{ for } \colorTbar < \colorT.
\end{align*}

The same approximate lower bound on best-case gap size ratio derived for the stretched curation can be applied also to tilted curation,
\begin{align*}
\frac{\colorG_{\colorT}(\colorTbar)}{\colorTbar}
&\stackrel{\sim}{\geq}
\colorT^{1/\colorS} - 1.
\tag{Equation \ref{eqn:approx-gap-bound}}
\end{align*}
As can the strict bound on stretched algorithm gap size ratio acounting for discretiztion effects,
\begin{align*}
\frac{\colorG_{\colorT}(\colorTbar)}{\colorT - \colorTbar}
&\geq
\frac{
  1
}{
  1 + \colorS
  - \left\lfloor \colorS \log_{\colorT}\Big(
    (\colorT - \colorS)(\colorT^{1/\colorS} - 1) + 1
  \Big)\right\rfloor
}.
\tag{Theorem \ref{thm:stretched-ideal-strict}}
\end{align*}

In this section, we present a stream curation algorithm tailored to the tilted criterion, achieving maximum gap size ratio no worse than,
\begin{align*}
  \frac{\colorG_{\colorT}(\colorTbar)}{\colorT - \colorTbar}
  &\leq
  \frac{
    1
  }{
    \max\Big(
      \frac{\colorS}{2(\colort + \colors)},
      \frac{\colorS}{4\colort},
      \frac{\colorS}{\left\lceil 2^{\colors - \colortau - 1} \right\rceil}
    \Big)
    - 1/2
  }.
\end{align*}

\subsection{Tilted Algorithm Strategy}
\label{sec:tilted-strategy}

\input{fig/hsurf-tilted-intuition.tex}

The retention strategy for the tilted algorithm strongly resembles that of the stretched algorithm.
Recall that under the stretched algorithm the first $n(\colorT)$ data items of each hanoi value $\colorH(\colorTbar)$ are retained, with $n(\colorT)$ degrading with time in shifting from many copies of few encountered hanoi values to few copies of many encountered hanoi values.
Under the tilted algorithm, we instead keep the \textit{last} $n(\colorT)$ data items of each hanoi value.
Figure \ref{fig:hanoi-intuition-tilted} shows how keeping the last $n$ instances of each h.v. approximates tilted distribution.

We thus define our algorithmic goal as maintaining --- for a declining threshold $n(\colorT)$ --- the set of data items,
\begin{align*}
\textsf{goal\_tilted}
&=
\bigcup_{\colorh \geq 0}
\{ \colorTbar \in \colorT, \colorT - 1, \, \ldots, \max(0, 2^{\colorh + 1}n(\colorT) - 1) : \colorH(\colorTbar) = \colorh \}.
\end{align*}
Note that by construction, $\textsf{goal\_tilted} \subset \{ \colorTbar \in 0, 1, \, \ldots, \colorT \}$.
As shown previously in Theorem \ref{thm:stretched-first-n-space}, setting $n(\colorT) = 2^{\colors - 1 - \colortau}$ suffices to respect available buffer capacity $\colorS$.

\subsection{Tilted Algorithm Mechanism}
\label{sec:tilted-mechanism}

Because the tilted algorithm, like the stretched algorithm, also follows an equal-$n$-per-h.v. scheme, hanoi value reservation layout is maintained identically to that of the stretched algorithm.
Refer to Section \ref{sec:stretched-mechanism} for a detailed description and justification of hanoi value reservation layout, and how it is progressed across epochs $\colort$ and meta-epochs $\colortau$.

A pertinent result of the stretched layout, though, is that the at least $2^{\colors - 1 - \colortau}$ data item instances of each h.v. are retained (Lemma \ref{thm:stretched-reservation-count}).
However, unlike the stretched algorithm, for the tilted algorithm we wish to keep the \textit{last} $n$ rather than the \textit{first} $n$ instances of each hanoi value.
We can do that by continuing to write data items for each h.v. into reservation slots for that h.v. after they initially fill --- overwriting older instances of the h.v. to keep a ``ring buffer'' of fresh h.v. instances.

In the following, we prove several results related to this cyclical-overwrite mechanism --- notably, including that it aligns evenly to epoch and meta-epoch transitions.
Ultimately, these results lead up to Lemma \ref{thm:tilted-most-recent-retained}, which confirms that our strategy always preserves the last $2^{\colors - 1 - \colortau}$ instances of each h.v., including through transitions where reservation site count for a h.v. is shrunk by half due to invasion.

\input{thm/tilted-last-touched}

\input{thm/tilted-last-overwritten}

\input{thm/tilted-invader-minus-invaded}

\input{thm/tilted-invading-overwrite-order}

\input{thm/tilted-most-recent-retained}

\subsection{Tilted Algorithm Implementation}
\label{sec:tilted-implementation}

\input{fig/hsurf-tilted-implementation.tex}

Site selection for data ingest proceeds similarly to that of the stretched algorithm, described in Section \ref{sec:stretched} -- with the exception that, instead of discarding data items once available sites reserved to that h.v. have filled, we simply cycle back and overwrite data items within that h.v.'s reservations in the order that they were added.
In practice, the target index among available sites reserved to a h.v. can be calculated as the number of previous times a h.v. has been encountered before time $\colorT$, modulus the number of sites reserved to that hanoi value.
Figure \ref{fig:hsurf-stretched-implementation-schematic} illustrates site selection over epochs $\colort=0,1,2$ on buffer size $\colorS=32$.

Ingestion time calculation for lookup of the data item at buffer site $\colork$ at time $\colorT$ can be accomplished by decoding that site's segment index and checking whether (if slated) it has yet been replaced during the current epoch $\colort$.
As before, both site selection and ingest time calculation can be accomplished through fast $\mathcal{O}(1)$ binary operations (e.g., bit mask, bit shift, count leading zeros).
We refer the reader to our supplemental Python-language implementation for an exact step-by-step listing of both operations for the stretched algorithm.

\subsection{Tilted Algorithm Criterion Satisfaction}
\label{sec:tilted-satisfaction}

In this final subsection, we establish an upper bound on gap size ratio $\colorg/(\colorT - \colorTbar)$ for a buffer of size $\colorS$ at time $\colorT$ under the proposed tilted curation algorithm.

\input{thm/tilted-gap-size}

Consideration of the gap size bound result found in Theorem \ref{thm:stretched-gap-size} at early and late epochs $\colort$ is instructive.
During early epoch $\colort = 1$, $\colorG_{\colorT}(\colorTbar)/(\colorT - \colorTbar) \leq 4/\colorS$.
Likewise, during the last supported epoch, where $\colortau = \colors$, $\colorG_{\colorT}(\colorTbar)/(\colorT - \colorTbar) \leq 2$.
Figure \ref{fig:hsurf-tilted-implementation-satisfaction} shows algorithm performance on the stretched criterion for buffer size $\colorS=16$, $0 \leq \colorT < 2^{\colorS}$.
