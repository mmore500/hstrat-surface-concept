\begin{lemma}[Last instance of a \hv{} within epoch $\colort$]
\label{thm:tilted-last-touched}
The final instance of each \hv{} encountered during an epoch is placed in the rightmost site reserved for that hanoi value.
That is, during any epoch $\colort$,
\begin{align*}
\colorK\Big(
  \max\{\colorT \in \colortsetofT : \colorH(\colorT) = \colorh\}
\Big)
=
\max\{\colork \in [0\twodots\colorS) : \colorHcal_{\colort}(\colork) = \colorh \}
\end{align*}
for all $\colorh \in \{\colorHcal_{\colort}(\colork) : \colork \in [0\twodots\colorS)\}$.
\end{lemma}

\begin{proof}
Because we are only concerned with pertinent \hv{} $\colorh \in \{\colorH(\colorT) : \colorT \in \colortsetofT\}$, we may assume $\colorh \leq \colors + \colort$.
In traversing a hanoi value's ``ring buffer'' of reserved sites, the rightmost reservation segment is visited last, as it is positioned rightmost within the set of smallest size segments.
Our proof objective can thus be fulfilled by showing that the number of sites $\colork$ reserved to \hv{} $\colorh$ evenly divides the number of \hv{} $\colorh$ instances encountered during epoch $\colort$.
That is, we wish to show
\begin{align*}
\\
\eqnmarkbox[WildStrawberry]{numitemsh}{
  \mathsf{num\_items}_{\colorh}
}
\bmod
\eqnmarkbox[WildStrawberry]{numsitesh}{
  \mathsf{num\_sites}_{\colorh}
}
&= 0.
\end{align*}

\annotate[yshift=1em]{above,left}{numitemsh}{$|\{
  \colorT \in \colortsetofT : \colorH(\colort) = \colorh
\}|$}
\annotate[yshift=1em]{above,right}{numsitesh}{$|\{
  \colork \in [0\twodots\colorS) : \colorHcal_{\colort}(\colork) = \colorh
\}|$}

How many instances of a hanoi value $\colorh$ are encountered during epoch $\colort$?
This is
\begin{align*}
\textsf{num\_items}_{\colorh}
&=
2^{\colort + \colors - \colorh} - \left\lfloor2^{\colort + \colors - \colorh - 1} \right\rfloor.
\end{align*}
Observe that $\textsf{num\_items}_{\colorh} \in \{2^{\mathbb{N}}\}$ for encountered \hv{}'s $\colorh \leq \colors + \colort$.

How many sites are reserved to a hanoi value $\colorh$ during epoch $\colort$?
Recall from Lemma \ref{thm:stretched-discarded-incidence-count} that this is
\begin{align*}
\textsf{num\_sites}_{\colorh}
&\geq
\min\Big(
\left\lceil 2^{\colors - \colortau - 1} \right\rceil,
2^{\colors + \colort - \colorh} - \left\lfloor 2^{\colors + \colort - \colorh - 1} \right\rfloor
\Big).
\end{align*}
Remark also that $\textsf{num\_sites}_{\colorh} \in \{2^{\mathbb{N}}\}$ for encountered \hv{}'s' $\colorh \leq \colors + \colort$.

Because both $\textsf{num\_items}_{\colorh} \in \{2^{\mathbb{N}}\}$ and $\textsf{num\_sites}_{\colorh} \in \{2^{\mathbb{N}}\}$ for encountered \hv{}'s, all that remains to be shown is $\textsf{num\_items}_{\colorh} \geq \textsf{num\_sites}_{\colorh}$.
Consider,
\begin{align*}
2^{\colort + \colors - \colorh} - \left\lfloor2^{\colort + \colors - \colorh - 1} \right\rfloor
&\stackrel{?}{\geq}
\min\Big(
\left\lceil 2^{\colors - \colortau - 1} \right\rceil,
2^{\colors + \colort - \colorh} - \left\lfloor 2^{\colors - \colorh - 1} \right\rfloor
\Big)\\
&\stackrel{\checkmark}{\geq}
2^{\colors + \colort - \colorh} - \left\lfloor 2^{\colors - \colorh - 1} \right\rfloor.
\end{align*}
\end{proof}
