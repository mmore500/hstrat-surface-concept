\begin{lemma}[Last instance of a \hv{} within epoch $\colort$]
\label{thm:tilted-last-touched}
The final instance of each \hv{} encountered during an epoch is placed in the rightmost site reserved for that hanoi value.
That is, during any epoch $\colort$
\begin{align*}
\colorK\Big(
  \max\{\colorT \in \colortsetofT : \colorH(\colorT) = \colorh\}
\Big)
=
\max\{\colork \in [0\twodots\colorS) : \colorHcal_{\colort}(\colork) = \colorh \}
\end{align*}
for all $\colorh \in \{\colorHcal_{\colort}(\colork) : \colork \in [0\twodots\colorS)\}$.
\end{lemma}

\begin{proof}
Hanoi value instances do not cycle back to leftmost reservation $r=\colors$ until the number of encountered \hv{} instances $2^{\colort + \colors - \colorh}$ exceeds space for $2^{\colors - \colortau - 1}$ items guaranteed by Lemma \ref{thm:stretched-discarded-incidence-count}.
Before this point, $\colorh \geq \colort + \colortau + 1$.
We will consider this case separately from $\colorh < \colort + \colortau + 1$.

\begin{proofpart}[$\colorh \geq \colort + \colortau + 1$]
\label{thm:hgeqttau}
Order segment bunches by descending initial size $r$.
Observe that bunches $0,1,\;\;\ldots,i$ contain a total of $2^i$ segments.
Placing into segments belonging to bunch $i = \colort + \colors - \colorh$ sychronizes accrued reservations with net encountered \hv{} instances, $2^{\colort + \colors - \colorh}$.
Filling a new, smaller $r$ bunch layer each epoch ensures the rightmost reserved site is filled last each epoch.
\end{proofpart}

\begin{proofpart}[$\colorh < \colort + \colortau + 1$]
In this case, the number of sites reserved to a \hv{} $\colorh$ will be $2^{\colors - 1 - \colortau}$ or, if the current meta-epoch's pending invasion has not yet reached \hv{} $\colorh$, $2 \times 2^{\colors - 1 - \colortau}$.
If, given the latter, reserved sites equal encountered \hv{} instances $2^{\colort + \colors - \colorh} = 2 \times 2^{\colors - 1 - \colortau}$, simply proceed to fill $i$th bunch $i=\colort + \colors - \colorh$ as in the above Part \ref{thm:hgeqttau}.

Otherwise, to ensure completion of exactly full cycles around our ``ring buffer'' of sites reserved to \hv{} $\colorh$, we must show that the number of sites $\colork$ reserved to \hv{} $\colorh$ evenly divides the number of \hv{} $\colorh$ instances encountered during epoch $\colort$.
That is, we wish to show
\begin{align*}
\\
\eqnmarkbox[gray]{numitemsh}{
  \mathsf{num\_items}_{\colorh}
}
\bmod
\eqnmarkbox[gray]{numsitesh}{
  \mathsf{num\_sites}_{\colorh}
}
&= 0.
\annotate[yshift=1em]{above,left}{numitemsh}{$|\{
  \colorT \in \colortsetofT : \colorH(\colort) = \colorh
\}|$}
\annotate[yshift=1em]{above,right}{numsitesh}{$|\{
  \colork \in [0\twodots\colorS) : \colorHcal_{\colort}(\colork) = \colorh
\}|$}
\end{align*}

How many instances of a hanoi value $\colorh$ are encountered during epoch $\colort$?
This is
\begin{align*}
\textsf{num\_items}_{\colorh}
= 2^{\colort + \colors - \colorh} - \left\lfloor 2^{\colort + \colors - \colorh - 1}\right\rfloor.
\end{align*}

How many sites are reserved to a hanoi value $\colorh$ during epoch $\colort$?
As established above, we only concern
\begin{align*}
\textsf{num\_sites}_{\colorh}
&<
2^{\colort + \colors - \colorh}\\
&\leq
2^{\colort + \colors - \colorh - 1}.
\end{align*}
Because both $\textsf{num\_items}_{\colorh}$ and $\textsf{num\_sites}_{\colorh}$ are $\in \{2^{\mathbb{N}}\}$, all that remains is to show
\begin{align*}
\textsf{num\_items}_{\colorh}
&\stackrel{?}{\geq}
\textsf{num\_sites}_{\colorh}\\
2^{\colort + \colors - \colorh} - \left\lfloor 2^{\colort + \colors - \colorh - 1}\right\rfloor
&\stackrel{\checkmark}{\geq}
2^{\colort + \colors - \colorh - 1}.
\end{align*}
\end{proofpart}
\end{proof}
