\begin{lemma}[Space Required to Store $\textsf{goal\_stretched}$]
\label{thm:stretched-first-n-space}

Buffer space $\colorS$ suffices to store set $\textsf{goal\_stretched}$.
That is,
\begin{align*}
|\bigcup_{\colorh \geq 0}
\{ \colorTbar = i2^{\colorh + 1} + 2^{\colorh} - 1 \text{ for } i \in 0,1,\,\ldots,n(t) : \colorTbar < \colorT \}| \leq \colorS
\end{align*}
for $n(\colorT) = \left\lceil 2^{\colors - 1 - \colortau} \right\rceil$.
\end{lemma}
\begin{proof}
We will consider final supported meta-epoch $\colortau=\colors$ separately from earlier meta-epochs $\colortau<\colors$.

\begin{proofpart}[Case $\colortau < \colors$]
Because each time point $\colorTbar$ has only one h.v. $\colorH(\colorTbar)$,
\begin{align*}
|\textsf{goal\_stretched}|
&=
\sum_{\colorh} \min\Big(2^{\colors - 1 - \colortau}, |\{ \colorTbar \leq \colorT : \colorH(\colorTbar) = \colorh \}|\Big)\\
&=
1 + \sum_{\colorh=0}^{\colors + \colort - 1} \min\Big(2^{\colors - 1 - \colortau}, 2^{\colors + \colort - 1 - \colorh}\Big)\\
&=
1 + \sum_{\colorh=0}^{\colors + \colort - 1} \min\Big(2^{\colors - 1 - \colortau}, 2^{\colors + \colort - 1 - \colorh}\Big).
\end{align*}
Splitting where $\colors - 1 - \colortau = \colors + \colort - 1 - \colorh$ (i.e., $\colorh = \colort + \colortau$),
\begin{align*}
|\textsf{goal\_stretched}|
&=
1 + \sum_{\colorh=0}^{\colort + \colortau} 2^{\colors - 1 - \colortau} + \sum_{\colorh=\colort + \colortau + 1}^{\colors + \colort - 1} 2^{\colors + \colort - 1 - \colorh}\\
&=
1 + (\colort + \colortau + 1) 2^{\colors - 1 - \colortau} + 2^{\colors - 1 - \colortau} - 1\\
&=
(\colort + \colortau + 2) 2^{\colors - 1 - \colortau}\\
&\leq
(2^{\colortau + 1} - (\colortau + 1) - 1 + \colortau + 2) 2^{\colors - 1 - \colortau}\\
&\leq
(2^{\colortau + 1}) 2^{\colors - 1 - \colortau}\\
&\leq
2^{\colors}\\
&\stackrel{\checkmark}\leq
\colorS.
\end{align*}
\end{proofpart}

\begin{proofpart}[Case $\colortau=\colors$]
During final meta-epoch $\colortau=\colors$, every h.v. has exactly one reserved site.
Thus,
\begin{align*}
|\textsf{goal\_stretched}|
&=
\sum_{\colorh} 1\\
&= \colors + \colort\\
&= \colors + \colorS - \colors\\
&\stackrel{\checkmark}{\leq} \colorS.
\end{align*}
\end{proofpart}

% Solving
% \begin{align*}
% \colors + \colort - 1 - \colorh &= \colors - 1 - \colortau\\
% \colorh &= \colort + \colortau.
% \end{align*}



% for $\colort$ such that $\colorTbar \in \colort$.


% Recalling that $\colorH(\colorTbar) \leq \left\lfloor \log_2\colorT + 1 \right\rfloor$ for $\colorTbar \leq \colorT$, we can formulate our cardinality in terms of \textit{not-yet-encountered} h.v. instances,

% \begin{align*}
% \left\lfloor \log_2\colorT + 1 \right\rfloor
% \times (\colors - 1 - \colortau)
% -
% \sum_{\colorh=0}^{\left\lfloor \log_2\colorT + 1 \right\rfloor
% } |
% \{ \colorTbar \in \colorT, \colorT + 1, \, \ldots, 2^{\colorh + 1}(\colors - 1 - \colortau) - 1 : \colorH(\colorTbar) = \colorh \}
% |.
% \end{align*}
\end{proof}
